import"abortcontroller-polyfill/dist/abortcontroller-polyfill-only";import{fetch as t}from"whatwg-fetch";function e(t,e,r){return new Promise(function(n,o){function i(t,e,r,n){if(t>0){t--;var i=function(t,e){var r=t.retryDelay,n=t.factor,o=t.retries;return n&&"number"==typeof n&&Number.isInteger(n)?function(t,e){return Math.pow(t,e)}(n,o-e):r*(o-e)}(r,t);r.onRetry&&"function"==typeof r.onRetry&&r.onRetry({retriesLeft:t,retryDelay:i,response:n}),setTimeout(function(){return u(e,r,t)},i)}else o(n)}function u(t,e,r){var u=e.retryStatus;(0,e.fetcher)(t,e).then(function(o){u.includes(o.status)?i(r,t,e,o):n(o)}).catch(function(n){e.retryOnFatalError?i(r,t,e,n):o(n)})}u(e,r,t)})}var r=!1;function n(t,n){void 0===t&&(t=""),void 0===n&&(n={});var o=new AbortController;if(!(n=Object.assign({retries:1,retryDelay:1e3,retryStatus:[],retryOnFatalError:!0,fetcher:r,signal:o.signal,timeout:void 0},n)).fetcher||"function"!=typeof n.fetcher)throw new Error("tenacious-fetch: No fetch implementation found. Provide a valid fetch implementation via the fetcher configuration property.");"string"!=typeof n.retryStatus&&"number"!=typeof n.retryStatus||(n.retryStatus=[Number.parseInt(n.retryStatus)]);var i=n.timeout;return i&&Number.isInteger(i)?Promise.race([e(n.retries,t,n),new Promise(function(t,e){return setTimeout(function(){o.abort(),e(new Error("tenacious-fetch: Request took longer than timeout of "+i+" ms."))},i)})]):e(n.retries,t,n)}r=window&&window.fetch&&"signal"in new window.Request("")?window.fetch:t;export{n as default};
//# sourceMappingURL=tenacious-fetch.m.js.map
